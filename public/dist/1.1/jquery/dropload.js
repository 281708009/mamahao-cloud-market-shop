+function($){"use strict";$.support=function(){var t={touch:!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)};return t}(),$.touchEvents={start:$.support.touch?"touchstart":"mousedown",move:$.support.touch?"touchmove":"mousemove",end:$.support.touch?"touchend":"mouseup"},$.getTouchPosition=function(t){return t=t.originalEvent||t,"touchstart"===t.type||"touchmove"===t.type||"touchend"===t.type?{x:t.targetTouches[0].pageX,y:t.targetTouches[0].pageY}:{x:t.pageX,y:t.pageY}}}($),+function($){"use strict";var t=function(t){this.container=$(t),this.distance=50,this.attachEvents()};t.prototype.touchStart=function(t){if(!this.container.hasClass("refreshing")){var s=$.getTouchPosition(t);this.start=s,this.diffX=this.diffY=0}},t.prototype.touchMove=function(t){if(!this.container.hasClass("refreshing")){if(!this.start)return!1;if(!(this.container.scrollTop()>0)){var s=$.getTouchPosition(t);if(this.diffX=s.x-this.start.x,this.diffY=s.y-this.start.y,!(this.diffY<0))return this.container.addClass("touching"),t.preventDefault(),t.stopPropagation(),this.diffY=Math.pow(this.diffY,.8),this.statusArea.css("height",this.diffY),this.diffY<this.distance?this.container.removeClass("pull-up").addClass("pull-down"):this.container.removeClass("pull-down").addClass("pull-up"),!1}}},t.prototype.touchEnd=function(){if(this.start=!1,!(this.diffY<=0||this.container.hasClass("refreshing")))return this.container.removeClass("touching"),this.container.removeClass("pull-down pull-up"),Math.abs(this.diffY)<=this.distance?this.statusArea.css("height",0):(this.statusArea.css("height",50),this.container.addClass("refreshing"),this.container.trigger("pull-to-refresh")),!1},t.prototype.attachEvents=function(){var t=this.container;t.addClass("dropload");var s=['<div class="dropload-layer">','<div class="inner">','<div class="arrow"></div>','<div class="loader"></div>','<div class="down">下拉刷新</div>','<div class="up">释放刷新</div>','<div class="refresh">正在刷新</div></div></div>'];this.statusArea=$(s.join("")).prependTo(t),t.on($.touchEvents.start,$.proxy(this.touchStart,this)),t.on($.touchEvents.move,$.proxy(this.touchMove,this)),t.on($.touchEvents.end,$.proxy(this.touchEnd,this))};var s=function(s){new t(s)},i=function(t){$(t).removeClass("refreshing"),$(t).find(".dropload-layer").css("height",0)};$.fn.pullToRefresh=function(){return this.each(function(){s(this)})},$.fn.pullToRefreshDone=function(){return this.each(function(){i(this)})}}($);