define(function(require,exports,module){var o={elements:{},init:function(e){var s=$(e),a=s.find(".js-search"),t=s.find("#keywords"),i=s.find(".search-tips"),n=s.find(".autoshow");a.on("click",function(){var e=$.trim(t.val());return e?void o.searchGoods(e):(M.tips("关键字不能为空"),!1)}),s.on("click",".hot dd em",function(){var e=$(this).text();o.searchGoods(e,!1)}),s.on("click",".search-tips li, .history .list li",function(){var e=$(this).text();o.searchGoods(e)}),t.on("input",function(){var o=$.trim(t.val());o?M.ajax({showLoading:!1,url:"/api/searchKeywordTips",data:{data:JSON.stringify({keyword:o})},success:function(o){o.template?(n.addClass("none"),i.empty().append(o.template).removeClass("none")):(n.removeClass("none"),i.addClass("none"))}}):(n.removeClass("none"),i.addClass("none"))}),s.on("click",".js-del-history",function(){localStorage.removeItem(CONST.local_search_history),M.tips({body:"历史搜索记录已清除",callback:function(){$(".history").fadeOut(function(){$(this).remove()})}})})},searchGoods:function(o,e){if(e!==!1){var s=JSON.parse(localStorage.getItem(CONST.local_search_history))||[];s.unshift(o),localStorage.setItem(CONST.local_search_history,JSON.stringify(s.unique().slice(0,10)))}localStorage.removeItem(CONST.local_search_params),window.location.href="#/list/keywords="+o}};module.exports=o});