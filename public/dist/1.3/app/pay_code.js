define(function(require,exports,module){var o={tools:{},config:{api:{}},init:function(){var i=this,t=i.config;t.resource=3,VM&&$.extend(t,VM),2==t.status?M.tips("验证码已失效，请重试！"):3==t.status&&M.tips("验证码错误，请重试！"),1!=t.status&&2!=t.status&&3!=t.status||i.getVcode(),o.bindEvents()},bindEvents:function(){var o=this,i=o.config;i.isWeChat&&require.async("weixin",function(o){o.hideOptionMenu()}),$(".js-code-reload").on("click",function(){if(!i.isReload){i.isReload=!0,$(this).addClass("ban").html("正在更新，请稍后...");var o=window.location;window.location.href=[o.origin,o.pathname,"?k=",encodeURIComponent(M.url.query("k"))].join("")}}),$(".js-alipay").on("touchstart",function(){$(this).data("pay")||($(this).html("正在准备付款...").data("pay",!0),M.pay.alipay({data:{batchNo:i.orderNo,shopId:i.shopId,resource:i.resource}}))}),$(".js-weixin").on("touchstart",function(){M.pay.weixin({data:{orderNo:i.orderNo,openId:i.openId,shopId:i.shopId,resource:i.resource},callback:"/pay/codeSuccess.html?orderPayType=2"})}),$(".js-submit").on("click",function(){var o=$(".js-code");if(!i.isAjax){if(""==o.val())return M.tips("请输入图文验证码!");var t=window.location,n=M.url.params();n.vcode=o.val(),window.location.href=[t.origin,t.pathname,"?",$.param(n)].join("")}}),$(".js-image-vcode").on("touchend",function(){o.getVcode()})},getVcode:function(){var o=this;o.config;M.ajax({url:"/pay/codeImageVcode.html",success:function(o){$(".js-image-vcode").attr("src",o.src)}})}};o.init()});