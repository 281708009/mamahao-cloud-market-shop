define(function(require,exports,module){var a={config:{hashParams:function(){return M.url.getParams((location.hash.match(/(\w+=)([^\&]*)/gi)||[]).join("&"))},searchParams:function(){return JSON.parse(localStorage.getItem(CONST.local_search_params))||{}}},init:function(n){var t=a.config;t.$container=n;var i=t.$container;i.on("click",".u-tab ul li",a.goodsSort),i.on("click",".js-to-filter",a.toFilter),i.on("click",".js-ellipsis",function(){$(this).toggleClass("collapse")}),a.bindEvents()},bindEvents:function(){var n=a.config,t=n.$container,i=n.hashParams(),o=n.searchParams();setTimeout(function(){M.lazyLoad.init({container:t.find(".list")})},250);var s=$.extend({},o,i);$.pagination({params:s,keys:{index:"nextPageStart"},container:".u-goods-list",scrollBox:".m-goods-list .list",api:"/api/goods_list",fnLoading:function(a){a.append('<li class="tc pagination-loading">正在加载中...</li>')},fnSuccess:function(a,n){var t=a.data;return t.template?(n.append(t.template),void M.lazyLoad.init({container:n})):n.data("locked",!0)}}),require.async("headroom",function(){var a=t.find(".desc");a.headroom({scroller:t.find(".list")[0],onPin:function(){a.show()},onUnpin:function(){a.hide()}})})},goodsSort:function(){var n=(a.elements,a.config),t=n.$container,i=$(this),o=i.index();if(i.hasClass("active")&&!i.find("em")[0])return!1;i.hasClass("active")?i.toggleClass("down"):i.addClass("active").siblings().removeClass("active");var s=n.hashParams(),e={searchType:o,sort:i.hasClass("down")?0:1},r=JSON.parse(localStorage.getItem(CONST.local_search_params)),c=$.extend({},r,e,s);localStorage.setItem(CONST.local_search_params,JSON.stringify(c)),M.ajax({location:!0,url:"/api/goods_list",data:{data:JSON.stringify(c)},success:function(n){var i=$(n.template).find(".list").html();t.find(".list").empty().append(i),a.bindEvents()}})},toFilter:function(){var a=(location.hash.match(/(\w+=)([^\&]*)/gi)||[]).join("&");location.href="#/filter/"+a}};module.exports=a});